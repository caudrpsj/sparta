<!doctype html>
<html lang="en">


<head>

    <!-- jQuery를 import 합니다 -->



    <style>
        .word {
            margin: 30px auto;
            width: 700px;
        }

        .word2 {
            margin: 30px auto;
            width: 400px;
        }

        .word3 {
            margin: 30px auto;
            width: 100px;
        }

        .moneystyle {
            margin: 30px auto;
            width: 500px;
        }

        .image2 {
            width: 30px;
            height: 30px;
        }
    </style>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
        integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
        integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
        integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
        integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
    <!-- JQuery를 import 합니다 -->


    <script>

        $(document).ready(function () {
            q2();
        });

        function q1() {

            let input_name = $('#inputname').val();
            let input_number = $('#inputState').val();
            let input_address = $('#inputAddress').val();
            let input_zip = $('#inputZip').val();
            var regExp = /^01([0|1|6|7|8|9]?)-?([0-9]{3,4})-?([0-9]{4})$/;
            if (input_name == '') {
                alert('이름을 입력하세요');
                $('#inputname').focus();
            }
            else if (input_number == '갯수를 입력하세요') {
                alert('갯수를 입력하세요');
                $('#inputState').focus();
            }
            else if (input_address == '') {
                alert('주소 를 입력하세요');
                $('#inputAddress').focus();
            }
            else if (input_zip == '') {
                alert('전화번호를를 입력하세요');
                $('#inputZip').focus();
            }
            else if (!regExp.test($('#inputZip').val())) {
                alert("잘못된 휴대폰 번호입니다. 숫자, - 를 포함한 숫자만 입력하세요.");



            }
            else {
                // alert('입력은 잘했져');
                $.ajax({
                    type: "POST",
                    url: "/shoppings",
                    data: { name_give: input_name, number_give: input_number, address_give: input_address, zip_give: input_zip },
                    success: function (response) {
                        if (response['result'] == 'success') {
                            alert ('구매완료');
                            alert(response['msg']);
                            window.location.reload();
                            
                        }
                    }
                });
            }


        }









    </script>




    <!-- JQuery를 import 합니다 -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>


    <script>
        function q2() {

            $('#money').empty();
            $('#money2').empty();
            $.ajax({
                type: "GET",
                url: "https://api.manana.kr/exchange/rate.json",
                data: {},
                success: function (response) {

                    let money_temp = response["1"]["rate"];
                    let money_temp2 = response["2"]["rate"] * 100;
                    let money_temp3 = money_temp2.toFixed(2);

                    $('#money').append(money_temp);
                    $('#money2').append(money_temp3);

                }
            });

        }
        $(document).ready(function () {
            // $('#orders-box').html('');
            listing();
        });
        function listing() {
            // alert ('구매명단 로딩증');
            $.ajax({
                type: "GET",
                url: "/shoppings",
                data: {},
                success: function (response) {
                    if (response['result'] == 'success') {
                        let shoppings = response['shoppings'];
                        for (let i = 0; i < shoppings.length; i++) {
                            make_list(shoppings[i]['name'], shoppings[i]['number'], shoppings[i]['address'], shoppings[i]['zip']);
                        }
                    } else {
                        alert('리뷰를 받아오지 못했습니다');
                    }
                }
            })

        };

        function make_list(name, number, address, zip) {
            let make_show = ` <tr>
                        <th scope="row">${name}</th>
                        <td>${number}</td>
                        <td>${address}</td>
                        <td>${zip}</td>
                      </tr>`
            $('#orders-box').append(make_show);
        };

    </script>

    <!-- 파일 분리를 위한 코드 -->
    <!-- <link href="shop.css" rel="stylesheet"> 
      <script src="shop.js"></script> 
    -->


    <title>스파르타코딩클럽 | 수정스 숙제</title>



</head>

<body>
    <hr>
    <nav class="navbar navbar-light bg-light justify-content-between">
        <div class="card" style="width: 5rem;">
            <img class="card-img-top"
                src="https://gloomy.co.kr/web/product/big/201810/359805effdf645beea038e83087d058e.jpg"
                alt="Card image cap">
        </div>
        <a class="navbar-brand">
            <h2>수정스 마켓</h2>
        </a>

        <form class="form-inline">
            <input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
            <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
        </form>
    </nav>
    <hr>
    <div class="container">
        <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
            <ol class="carousel-indicators">
                <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
                <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
                <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
            </ol>
            <div class="carousel-inner">
                <div class="carousel-item active">
                    <img class="d-block w-100" src="https://www.spcmagazine.com/wp-content/uploads/2020/04/img07.jpg">
                </div>
                <div class="carousel-item">
                    <img class="d-block w-100" src="https://i.ytimg.com/vi/--6AsFDJqO4/maxresdefault.jpg"
                        alt="Second slide">
                </div>
                <div class="carousel-item">
                    <img class="d-block w-100"
                        src="https://img.insight.co.kr/static/2020/04/24/1200/o2sp102ml9wr1wc9dqv2.jpg"
                        alt="Third slide">
                </div>
            </div>
            <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="sr-only">Previous</span>
            </a>
            <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="sr-only">Next</span>
            </a>
        </div>
    </div>
    <div class="container">
        <!-- 제품설명 -->
        <div class="word2">
            <h1>펭수키링 <span class="badge badge-secondary">Best!</span></h1>
            가격: 3000원/1개
            <p>
                귀여운 펭수키링을 주문하세요 곧 품절됩니다
            </p>
        </div>

        <!-- 환율부분 -->
        <div class="moneystyle">
            <hr>
            </hr>
            <h6>달러환율: <a id="money"> </a></h6>
            <h6>일본환율: <a id="money2"> </a></h6>


            <hr>
            </hr>

        </div>


        <!-- 아래내용 -->

        <div class="word">

            <form>
                <div class="form-group row">

                    <label for="inputname" class="col-sm-2 col-form-label"> 주문자이름</label>
                    <div class="col-sm-10">
                        <input type="text" class="form-control" id="inputname" placeholder="이름을 입력하세요">
                    </div>
                </div>



                <div class="form-group row">
                    <label for="inputState" class="col-sm-2 col-form-label">수량</label>
                    <div class="col-sm-10">
                        <select id="inputState" class="form-control">
                            <option selected>갯수를 입력하세요</option>
                            <option>1</option>
                            <option>2</option>
                            <option>3</option>
                            <option>4</option>
                            <option>5</option>
                            <option>6</option>
                            <option>7</option>
                            <option>8</option>
                            <option>9</option>
                            <option>10</option>
                        </select>
                    </div>
                </div>
                <div class="form-group row">
                    <label for="inputAddress" class="col-sm-2 col-form-label">주소</label>
                    <div class="col-sm-10">
                        <input type="text" class="form-control" id="inputAddress" placeholder="">
                    </div>
                </div>
                <div class="form-group row">

                    <label for="inputZip" class="col-sm-2 col-form-label">전화번호</label>
                    <div class="col-sm-10">
                        <input type="text" class="form-control" id="inputZip" placeholder="OOO-OOOO-OOOO">
                    </div>
                </div>
                <div class="word3">
                    <button type="submit" class="btn btn-primary" onclick="q1()">주문하기</button>
                </div>
                <table class="table" >
                    <thead>
                        <tr>
                            <th scope="col">이름</th>
                            <th scope="col">수량</th>
                            <th scope="col">주소</th>
                            <th scope="col">전화번호</th>
                        </tr>
                    </thead>
                    <tbody id="orders-box">
                        <tr>
                            <th scope="row">박수정</th>
                            <td>1</td>
                            <td>서울시</td>
                            <td>010-9870-0645</td>
                        </tr>
                        <tr>
                            <th scope="row">2</th>
                            <td>Jacob</td>
                            <td>Thornton</td>
                            <td>@fat</td>
                        </tr>
                        <tr>
                            <th scope="row">3</th>
                            <td>Larry</td>
                            <td>the Bird</td>
                            <td>@twitter</td>
                        </tr>
                    </tbody>
                </table>
            </form>

        </div>





    </div>

</body>

</html>